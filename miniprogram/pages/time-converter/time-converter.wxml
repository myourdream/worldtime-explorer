<!-- pages/time-converter/time-converter.wxml -->
<view class="container">
  
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <text class="page-title">æ—¶åŒºè½¬æ¢</text>
    <text class="page-subtitle">åœ¨ä¸åŒæ—¶åŒºé—´è½¬æ¢æ—¶é—´</text>
  </view>

  <!-- æºæ—¶åŒºé€‰æ‹© -->
  <view class="timezone-section">
    <view class="section-title">æºæ—¶åŒº</view>
    <view class="timezone-selector" bindtap="selectSourceTimezone">
      <view class="timezone-info">
        <text class="timezone-name">{{sourceTimezone.name || 'é€‰æ‹©æ—¶åŒº'}}</text>
        <text class="timezone-detail" wx:if="{{sourceTimezone.timezone}}">{{sourceTimezone.timezone}}</text>
      </view>
      <text class="selector-arrow">></text>
    </view>
    
    <!-- æºæ—¶åŒºæ—¶é—´æ˜¾ç¤º -->
    <view class="time-display-section" wx:if="{{sourceTimezone.timezone}}">
      <time-display 
        time="{{sourceTime}}" 
        timezone="{{sourceTimezone.timezone}}"
        format="FULL"
        show-seconds="{{true}}"
        show-date="{{true}}"
        size="normal"
        theme="gradient">
      </time-display>
    </view>
  </view>

  <!-- è½¬æ¢æŒ‰é’® -->
  <view class="convert-section">
    <button class="convert-btn" bindtap="performConversion" disabled="{{!sourceTimezone.timezone || !targetTimezone.timezone}}">
      <text class="convert-icon">ğŸ”„</text>
      <text class="convert-text">è½¬æ¢æ—¶é—´</text>
    </button>
  </view>

  <!-- ç›®æ ‡æ—¶åŒºé€‰æ‹© -->
  <view class="timezone-section">
    <view class="section-title">ç›®æ ‡æ—¶åŒº</view>
    <view class="timezone-selector" bindtap="selectTargetTimezone">
      <view class="timezone-info">
        <text class="timezone-name">{{targetTimezone.name || 'é€‰æ‹©æ—¶åŒº'}}</text>
        <text class="timezone-detail" wx:if="{{targetTimezone.timezone}}">{{targetTimezone.timezone}}</text>
      </view>
      <text class="selector-arrow">></text>
    </view>
    
    <!-- ç›®æ ‡æ—¶åŒºæ—¶é—´æ˜¾ç¤º -->
    <view class="time-display-section" wx:if="{{targetTimezone.timezone && convertedTime}}">
      <time-display 
        time="{{convertedTime}}" 
        timezone="{{targetTimezone.timezone}}"
        format="FULL"
        show-seconds="{{true}}"
        show-date="{{true}}"
        size="normal"
        theme="gradient">
      </time-display>
    </view>
  </view>

  <!-- æ—¶é—´å·®ä¿¡æ¯ -->
  <view class="time-difference" wx:if="{{timeDifference !== null}}">
    <view class="difference-card">
      <text class="difference-label">æ—¶åŒºå·®</text>
      <text class="difference-value">{{timeDifference}}</text>
    </view>
  </view>

  <!-- å¿«æ·æ—¶åŒº -->
  <view class="quick-timezones">
    <view class="section-title">å¿«æ·æ—¶åŒº</view>
    <view class="timezone-grid">
      <view class="quick-timezone-item" 
            wx:for="{{quickTimezones}}" 
            wx:key="timezone"
            bindtap="selectQuickTimezone"
            data-timezone="{{item}}">
        <text class="quick-flag">{{item.flag}}</text>
        <text class="quick-name">{{item.name}}</text>
        <text class="quick-country">{{item.country}}</text>
      </view>
    </view>
  </view>

  <!-- è‡ªå®šä¹‰æ—¶é—´è¾“å…¥ -->
  <view class="custom-time-section">
    <view class="section-title">è‡ªå®šä¹‰æ—¶é—´</view>
    <view class="time-input-card">
      <view class="input-group">
        <text class="input-label">æ—¥æœŸ</text>
        <picker mode="date" value="{{customDate}}" bindchange="onDateChange">
          <view class="picker-input">{{customDate}}</view>
        </picker>
      </view>
      <view class="input-group">
        <text class="input-label">æ—¶é—´</text>
        <picker mode="time" value="{{customTime}}" bindchange="onTimeChange">
          <view class="picker-input">{{customTime}}</view>
        </picker>
      </view>
      <button class="apply-time-btn" bindtap="applyCustomTime" size="mini">åº”ç”¨æ—¶é—´</button>
    </view>
  </view>

  <!-- è½¬æ¢å†å² -->
  <view class="conversion-history" wx:if="{{conversionHistory.length > 0}}">
    <view class="section-title">è½¬æ¢å†å²</view>
    <view class="history-list">
      <view class="history-item" 
            wx:for="{{conversionHistory}}" 
            wx:key="index"
            bindtap="useHistoryItem"
            data-item="{{item}}">
        <view class="history-info">
          <text class="history-source">{{item.source.name}} â†’ {{item.target.name}}</text>
          <text class="history-time">{{item.time}}</text>
        </view>
        <text class="history-arrow">></text>
      </view>
    </view>
    <button class="clear-history-btn" bindtap="clearHistory" size="mini">æ¸…ç©ºå†å²</button>
  </view>

  <!-- æ“ä½œæç¤º -->
  <view class="operation-tips">
    <text class="tip-text">ğŸ’¡ é€‰æ‹©æºæ—¶åŒºå’Œç›®æ ‡æ—¶åŒºï¼Œç‚¹å‡»è½¬æ¢æŒ‰é’®è¿›è¡Œæ—¶é—´è½¬æ¢</text>
  </view>
</view>
